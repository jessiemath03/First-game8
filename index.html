<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jessie Math - åˆ†æ•¸å†’éšª</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #ffcc00;
            --blue: #4a90e2;
            --red: #ff6b6b;
            --green: #2ecc71;
            --white: #ffffff;
        }

        * { box-sizing: border-box; font-family: sans-serif; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background-color: #f4f7f9; color: #333; line-height: 1.5; }

        /* Header å“ç‰Œå€ */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 10px 15px; background: var(--white); box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky; top: 0; z-index: 100;
        }
        .logo-area { display: flex; align-items: center; }
        .logo-circle {
            width: 40px; height: 40px; background: var(--primary);
            border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 8px;
        }
        .logo-circle img { width: 30px; height: auto; }
        .nav-links a { text-decoration: none; color: #666; font-size: 11px; margin-left: 10px; text-align: center; display: inline-block; }
        .nav-links i { display: block; font-size: 18px; margin-bottom: 2px; }

        /* ä¸»å®¹å™¨ */
        #main-container { max-width: 450px; margin: 15px auto; padding: 0 10px; }
        .card { background: var(--white); border-radius: 25px; padding: 25px 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.08); text-align: center; position: relative; overflow: hidden; }

        .screen { display: none; }
        .active { display: block; }

        /* æŒ‰éˆ•æ¨£å¼ */
        .btn {
            background: var(--primary); border: none; padding: 16px 20px;
            border-radius: 50px; font-size: 18px; cursor: pointer; font-weight: bold;
            margin: 10px 0; width: 100%; box-shadow: 0 5px 0 #d4aa00; transition: 0.1s;
        }
        .btn:active { transform: translateY(3px); box-shadow: 0 2px 0 #d4aa00; }
        .btn-blue { background: var(--blue); color: white; box-shadow: 0 5px 0 #2a6cb3; }

        /* éŠæˆ²å°ˆå±¬æ¨£å¼ */
        .stats { display: flex; justify-content: space-around; margin-bottom: 10px; font-size: 22px; font-weight: bold; }
        .timer { color: var(--red); }
        .feedback-area { min-height: 65px; font-size: 22px; font-weight: bold; margin: 10px 0; display: flex; flex-direction: column; justify-content: center; }
        .question-box { min-height: 180px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #fdfdfd; border: 2px solid #eee; border-radius: 20px; padding: 10px; }
        .ans-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 15px; }

        /* æ§åˆ¶æŒ‰éˆ• */
        .control-row { display: flex; gap: 10px; margin-top: 25px; }
        .btn-ctrl { flex: 1; padding: 12px; border: none; border-radius: 15px; background: #eee; font-weight: bold; font-size: 14px; cursor: pointer; }
        .btn-ctrl i { display: block; font-size: 18px; margin-bottom: 4px; }

        /* æš«åœé®ç½© */
        #pause-mask {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.96); z-index: 50; flex-direction: column; align-items: center; justify-content: center;
        }

        /* è¼¸å…¥æ¡†èˆ‡åˆ—è¡¨ */
        input { width: 100%; padding: 15px; border-radius: 15px; border: 2px solid #ddd; font-size: 18px; margin-bottom: 20px; outline: none; }
        .rank-list { text-align: left; background: #f9f9f9; padding: 15px; border-radius: 15px; margin-top: 15px; border: 1px solid #eee; }
        .rank-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dashed #ddd; }
        .rank-item:last-child { border: none; }
    </style>
</head>
<body>

<header>
    <div class="logo-area">
        <div class="logo-circle"><img src="JESSIEMATH-Q.png" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3426/3426653.png'"></div>
        <b style="font-size: 20px;">Jessie Math</b>
    </div>
    <div class="nav-links">
        <a href="https://jessiemath0703-chu.github.io/website2/"><i class="fas fa-home"></i>é¦–é </a>
        <a href="https://jessiemath0703-chu.github.io/Game-Lobby/"><i class="fas fa-gamepad"></i>å¤§å»³</a>
        <a href="https://jessiemath0703-chu.github.io/Game-Lobby/#g3-u8"><i class="fas fa-arrow-left"></i>ä¸‰å¹´ç´šåˆ†æ•¸</a>
    </div>
</header>

<div id="main-container">
    <div class="card">
        <div id="pause-mask">
            <h2>éŠæˆ²æš«åœä¸­</h2>
            <button class="btn btn-blue" onclick="togglePause()">ç¹¼çºŒéŠæˆ²</button>
        </div>

        <div id="page-1" class="screen active">
            <h2 style="color:var(--blue)">åˆ†æ•¸å†’éšªå¤§æŒ‘æˆ° ğŸš€</h2>
            <div style="background: #fff9e6; padding: 15px; border-radius: 15px; font-size: 15px; margin-bottom: 20px; text-align: left;">
                <b>ğŸ® éŠæˆ²ç©æ³•ï¼š</b><br>
                1. æ¯å±€ <b>60 ç§’</b>ï¼Œé¡Œç›®éš¨æ©Ÿå‡ºç¾ã€‚<br>
                2. âœ… ç­”å°ï¼š<b>+10åˆ†</b> ä¸¦ <b>åŠ 5ç§’</b>ã€‚<br>
                3. âŒ ç­”éŒ¯ï¼š<b>æ‰£5ç§’</b> ä¸¦é¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆã€‚
            </div>
            <input type="text" id="player-input" placeholder="è«‹å…ˆè¼¸å…¥ä½ çš„åå­—..." maxlength="10">
            <button class="btn" onclick="checkNameAndGo()">ä¸‹ä¸€æ­¥</button>
        </div>

        <div id="page-2" class="screen">
            <h3>ä½ å¥½, <span id="display-name" style="color:var(--blue)"></span>ï¼</h3>
            <p>è«‹é¸æ“‡æŒ‘æˆ°é—œå¡ï¼š</p>
            <button class="btn btn-blue" onclick="playGame(1)">1. å¹¾åˆ†ä¹‹å¹¾</button>
            <button class="btn btn-blue" onclick="playGame(2)">2. åˆ†æ•¸èˆ‡ 1</button>
            <button class="btn btn-blue" onclick="playGame(3)">3. å¤§å°æ¯”è¼ƒ</button>
            
            <div class="rank-list" id="rank-box">
                <b style="color: #666;"><i class="fas fa-trophy"></i> å‹‡è€…æ’è¡Œæ¦œ</b>
                <div id="rank-content" style="margin-top: 10px;">å°šæœªæœ‰ç´€éŒ„</div>
            </div>
            <button class="btn-ctrl" style="width:100%; margin-top: 10px;" onclick="location.reload()">æ›´æ›å‹‡è€…</button>
        </div>

        <div id="page-3" class="screen">
            <div class="stats">
                <div>Score: <span id="u-score">0</span></div>
                <div class="timer"><i class="fas fa-clock"></i> <span id="u-time">60</span>s</div>
            </div>
            
            <div id="u-feedback" class="feedback-area">åŠ æ²¹ï¼</div>

            <div class="question-box">
                <div id="q-title" style="font-size: 20px; font-weight: bold; margin-bottom: 10px;"></div>
                <div id="q-graphic"></div>
            </div>

            <div id="ans-buttons" class="ans-grid"></div>

            <div class="control-row">
                <button class="btn-ctrl" onclick="togglePause()"><i class="fas fa-pause"></i>æš«åœ</button>
                <button class="btn-ctrl" onclick="playGame(currentLv)"><i class="fas fa-redo"></i>é‡æ–°</button>
                <button class="btn-ctrl" onclick="backToMenu()"><i class="fas fa-list"></i>é¸å–®</button>
            </div>
        </div>

        <div id="page-4" class="screen">
            <h2>æ™‚é–“åˆ°ï¼â°</h2>
            <div id="u-stars" style="font-size: 50px; color: var(--primary); margin: 10px 0;"></div>
            <p style="font-size: 20px;">å‹‡è€… <b><span id="res-name"></span></b></p>
            <p style="font-size: 22px;">å¾—åˆ†ï¼š<b id="res-score" style="color:var(--blue)">0</b></p>
            <button class="btn" onclick="backToMenu()">å†æ¬¡æŒ‘æˆ°</button>
        </div>
    </div>
</div>

<script>
    let currentLv = 1;
    let score = 0, time = 60, combo = 0;
    let timerId = null, isPaused = false, correctAns = "";
    let playerName = "";
    let leaderboard = [];

    function show(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    // ç¬¬ä¸€é é‚è¼¯ï¼šå¼·åˆ¶è¼¸å…¥åå­—
    function checkNameAndGo() {
        const input = document.getElementById('player-input').value.trim();
        if (!input) {
            alert("è«‹è¼¸å…¥å‹‡è€…åå­—æ‰èƒ½é–‹å§‹å–”ï¼");
            return;
        }
        playerName = input;
        document.getElementById('display-name').innerText = playerName;
        show('page-2');
        updateRankUI();
    }

    // ç¬¬äºŒé é‚è¼¯ï¼šé–‹å§‹éŠæˆ²
    function playGame(lv) {
        currentLv = lv;
        score = 0; time = 60; combo = 0; isPaused = false;
        document.getElementById('u-score').innerText = "0";
        document.getElementById('u-time').innerText = "60";
        document.getElementById('u-feedback').innerText = "é å‚™...é–‹å§‹ï¼";
        document.getElementById('u-feedback').style.color = "#333";
        show('page-3');
        nextQ();
        startTimer();
    }

    function togglePause() {
        isPaused = !isPaused;
        document.getElementById('pause-mask').style.display = isPaused ? 'flex' : 'none';
    }

    function backToMenu() {
        clearInterval(timerId);
        show('page-2');
        updateRankUI();
    }

    function startTimer() {
        clearInterval(timerId);
        timerId = setInterval(() => {
            if (!isPaused) {
                time--;
                document.getElementById('u-time').innerText = time;
                if (time <= 0) endGame();
            }
        }, 1000);
    }

    function nextQ() {
        const title = document.getElementById('q-title');
        const graphic = document.getElementById('q-graphic');
        const grid = document.getElementById('ans-buttons');
        graphic.innerHTML = ""; grid.innerHTML = "";
        
        let choices = [];
        if (currentLv === 1) {
            title.innerText = "é€™æ˜¯å¹¾åˆ†ä¹‹å¹¾ï¼Ÿ";
            let d = Math.floor(Math.random() * 6) + 3, n = Math.floor(Math.random() * (d - 1)) + 1;
            correctAns = `${n}/${d}`;
            
            // è¼•é‡ SVG é¤…åœ–
            let svg = `<svg width="130" height="130" viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45" fill="#f0f0f0" stroke="#333" stroke-width="2"/>`;
            let x = 50 + 45 * Math.sin(2 * Math.PI * (n / d));
            let y = 50 - 45 * Math.cos(2 * Math.PI * (n / d));
            svg += `<path d="M50,50 L50,5 A45,45 0 ${(n/d)>0.5?1:0},1 ${x},${y} Z" fill="#ffcc00" stroke="#333"/>`;
            for(let i=0; i<d; i++) {
                let lx = 50 + 45 * Math.sin(2 * Math.PI * (i / d));
                let ly = 50 - 45 * Math.cos(2 * Math.PI * (i / d));
                svg += `<line x1="50" y1="50" x2="${lx}" y2="${ly}" stroke="#333" stroke-width="0.5"/>`;
            }
            svg += `</svg>`;
            graphic.innerHTML = svg;
            choices = [correctAns, `${d-n}/${d}`, `1/${d}`, `${n}/${d+1}`];
        } else if (currentLv === 2) {
            title.innerText = "é¸å‡ºç­‰æ–¼ 1 çš„åˆ†æ•¸";
            let n = Math.floor(Math.random() * 8) + 2;
            correctAns = `${n}/${n}`;
            graphic.innerHTML = "<i class='fas fa-star' style='font-size:50px; color:#ffcc00;'></i>";
            choices = [correctAns, `1/${n}`, `${n}/1`, `${n-1}/${n}`];
        } else {
            title.innerText = "æ¯”è¼ƒå¤§å°";
            let den = Math.floor(Math.random() * 7) + 3, n1 = Math.floor(Math.random() * (den - 1)) + 1, n2 = Math.floor(Math.random() * (den - 1)) + 1;
            while(n1 == n2) n2 = Math.floor(Math.random() * (den - 1)) + 1;
            graphic.innerHTML = `<div style="font-size:32px; font-weight:bold;">${n1}/${den}  ?  ${n2}/${den}</div>`;
            correctAns = n1 > n2 ? ">" : "<";
            choices = [">", "<", "="];
        }

        [...new Set(choices)].sort(() => Math.random() - 0.5).forEach(c => {
            const b = document.createElement('button');
            b.className = "btn btn-blue";
            b.style.fontSize = "18px";
            b.innerText = c;
            b.onclick = () => checkAns(c);
            grid.appendChild(b);
        });
    }

    function checkAns(v) {
        const feedback = document.getElementById('u-feedback');
        if (v === correctAns) {
            combo++; score += (10 + combo * 2); time += 5;
            feedback.innerText = "â­• æ­£ç¢ºï¼" + (combo > 1 ? ` ğŸ”¥ ${combo}é€£æ“Š` : "");
            feedback.style.color = "var(--green)";
        } else {
            combo = 0; time -= 5;
            feedback.innerHTML = `âŒ éŒ¯èª¤ï¼<br><span style="font-size:16px;">æ­£ç¢ºç­”æ¡ˆï¼š${correctAns}</span>`;
            feedback.style.color = "var(--red)";
        }
        document.getElementById('u-score').innerText = score;
        setTimeout(nextQ, 600);
    }

    function endGame() {
        clearInterval(timerId);
        show('page-4');
        document.getElementById('res-name').innerText = playerName;
        document.getElementById('res-score').innerText = score;
        document.getElementById('u-stars').innerText = score > 180 ? "â˜…â˜…â˜…" : (score > 90 ? "â˜…â˜…â˜†" : "â˜…â˜†â˜†");
        
        // å­˜å…¥æ’è¡Œ
        leaderboard.push({name: playerName, score: score});
        leaderboard.sort((a,b) => b.score - a.score);
    }

    function updateRankUI() {
        const box = document.getElementById('rank-content');
        if (leaderboard.length === 0) {
            box.innerHTML = "å°šæœªæœ‰ç´€éŒ„";
            return;
        }
        box.innerHTML = leaderboard.slice(0, 5).map((r, i) => 
            `<div class="rank-item"><span>${i+1}. ${r.name}</span><b>${r.score}åˆ†</b></div>`
        ).join('');
    }
</script>

</body>
</html>